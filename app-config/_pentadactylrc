" ~/.pentadactylrc

""" Start up
map <C-r> -ex rehash
map <C-S-r> -ex restart +purgecaches
set! browser.backspace_action=0
set! browser.link.open_newwindow=3
set! middlemouse.contentLoadURL=false

""" Input
map A -ex dialog about
map <C-j> -ex dialog downloads
map <C-S-b> -js window.PlacesCommandHook.showPlacesOrganizer('AllBookmarks')
map s <C-c>
map <C-space> <C-d>
map <C-S-space> <C-u>
map <A-$> -ex tabmove $
map <C-$> g$
map <F1> <C-^>
map <C-6> 6b
map <C-9> 9b
set activate-=diverted,links,tabopen,paste
set complete=location,search
bmark -keyword ddg -t DDG https://duckduckgo.com/?q=%s
set defsearch=ddg
set newtab=help
set hintkeys=$.aoeupjxyidhtnmz
set nextpattern^=›
set urlseparator=' , '

""" Display
map <A-t> -js content.document.toggleImageSize()
silent colorscheme solarized-light
set guioptions+=cN
set showstatuslinks=command
set hlfind
set pageinfo=fgmse
style -name 'GUI arrangement' -agent * <<EOS
#browser { -moz-box-ordinal-group: 0 }
#navigator-toolbox { -moz-box-ordinal-group: 2 }
#addon-bar { -moz-box-ordinal-group: 1001 }
#downbarHolder { -moz-box-ordinal-group: 2 }

[dlgtype="cancel"], [anonid="button1"] { -moz-box-ordinal-group: 2 }
EOS

""" Core
set editor='emacsclient +<line> <file>'

""" Sites
map <C-S-n> -ex bmarks! -tags news
map S -ex bmark https://www.youtube.com/html5 -tags setting
   \ bmark https://www.youtube.com/feather_beta -tags setting
   \ bmark -keyword ac -t config about:config
   \ bmark -keyword st -t sync-tabs about:sync-tabs
   \ bmark -keyword bgp -t BGP http://bgp.he.net/search?search[search]=%s
   \ bmark -keyword v -t valsi http://vlasisku.lojban.org/?query=%s
   \ bmark -keyword yb -t youtube https://www.youtube.com/watch?v=%s
   \ bmark -keyword cw -t 'CrawlWiki' http://crawl.chaosforge.org/index.php?title=Special%3ASearch&search=%s
   \ bmark -keyword dw -t 'Dota 2 Wiki' http://www.dota2wiki.com/index.php?title=Special%3ASearch&search=%s
   \ bmark -keyword dr -t 'Dota random' http://www.dota2wiki.com/wiki/Special:Random
   \ bmark -keyword df -t 'Dota 2 fix' http://dev.dota2.com/showthread.php?t=28814
   \ bmark -keyword lp -t LP http://lparchive.org/search/%s#results
   \ bmark -keyword ix -t ix -post f:1=%s http://ix.io/
   \ bmark -keyword io -t ixopen http://ix.io/%s/
   \ bmark -keyword i -t isohunt https://ca.isohunt.com/lite/#s=seeds&q=%s&p=1
   \ bmark -keyword ia -t isohunt https://ca.isohunt.com/lite/#s=age&q=%s&p=1
   \ bmark -keyword b -t btdigg https://btdigg.org/search?q=%s&order=0&p=0
   \ bmark -keyword tpb -t tpb https://thepiratebay.se/s/?q=%s&page=0
   \ bmark -keyword mt -t metasearch http://metasearch.torrentproject.com/#!search=%s
   \ bmark -keyword lf -t last.fm http://www.last.fm/user/hdh0#recentTracks
   \ bmark -keyword m -t zing http://mp3.zing.vn/tim-kiem/bai-hat.html?q=%s
   \ bmark -keyword ma -t artist http://musicbrainz.org/search?advanced=1&type=artist&tport=8000&query=%s
   \ bmark -keyword mg -t group http://musicbrainz.org/search?advanced=1&type=release_group&tport=8000&query=%s
   \ bmark -keyword mr -t recording http://musicbrainz.org/search?advanced=1&type=recording&tport=8000&query=%s
   \ bmark -keyword t -t train http://vh2e7a2imnfcr2rauxb3v6dxehe7wuxthucgcg2oh6bw22tyljtq.b32.i2p/pe/train.php
   \ bmark -keyword at -t asynctrain http://vh2e7a2imnfcr2rauxb3v6dxehe7wuxthucgcg2oh6bw22tyljtq.b32.i2p/pe/async/asynctrain.php
   \ bmark -keyword sp -t 'personal stats' http://vh2e7a2imnfcr2rauxb3v6dxehe7wuxthucgcg2oh6bw22tyljtq.b32.i2p/pe/stat.php?personal=1
   \ bmark -keyword ts -t 'tor cenba' https://atlas.torproject.org/#search/cenba
   \ bmark -keyword gm -t gmail https://mail.google.com/mail/#inbox -tags news
   \ bmark -keyword fbm -t 'fb chat' https://www.facebook.com/messages/%s
map <C-S-s> -ex bmarks! -tags setting
   \ set! browser.newtabpage.enabled=false
   \ set! browser.privatebrowsing.dont_prompt_on_enter=true
   \ set! browser.sessionstore.restore_pinned_tabs_on_demand=true
   \ set! browser.shell.checkDefaultBrowser=false
   \ set! browser.startup.homepage=about:blank
   \ set! browser.startup.page=3
   \ set! general.warnOnAboutConfig=false
   \ set! security.warn_viewing_mixed=false
   \ set! layout.spellcheckDefault=0
   \ set! middlemouse.paste=true
   \ set! ui.key.contentAccess=4
   \ set! ui.key.menuAccessKey=0
   \ set! browser.anchor_color="#6c71c4"
   \ set! browser.display.background_color="#fdf6e3"
   \ set! browser.display.foreground_color="#657b83"
   \ set! browser.display.use_system_colors=false
   \ set! browser.fullscreen.autohide=false
   \ set! browser.tabs.closeButtons=2
   \ set! browser.tabs.onTop=false
   \ set! general.smoothScroll=false
   \ set! font.default.x-western="sans-serif"
   \ if /NT 6/.test(window.navigator.oscpu)
   \     set! font.name.monospace.x-western=Consolas
   \     set! font.name.sans-serif.x-western=Calibri
   \     set! font.name.serif.x-western=Cambria
   \ fi
   \ set! capability.policy.yesscript.sites="http://bluescreenofawesome.com http://www.cracked.com http://www.escapistmagazine.com http://www.salon.com"
   \ set! downbar.display.clearButton=true
   \ set! downbar.display.mainButton=false
   \ set! downbar.display.speed=false
   \ set! downbar.display.toMiniButton=true
   \ set! downbar.function.clearFiletypes=""
   \ set! downbar.function.firstRun=false
   \ set! downbar.function.removeOnOpen=false
   \ set! downbar.function.soundCompleteIgnore="torrent"
   \ set! downbar.function.soundOnComplete=1
   \ set! downbar.style.speedColor0="0;#dc322f"
   \ set! downbar.style.speedColor1="50;#b58900"
   \ set! downbar.style.speedColor2="100;#859900"
   \ set! downbar.style.speedColor3="200;#2aa198"
   \ set! downbar.style.speedColorsEnabled=true
   \ set! downbar.style.useGradients=false
   \ set! extensions.checkCompatibility.8.0=false
   \ set! extensions.checkCompatibility.nightly=false
   \ extadd https://www.eff.org/files/https-everywhere-devel.xpi
   \ set! extensions.https_everywhere._observatory.alt_roots=true
   \ set! extensions.https_everywhere._observatory.enabled=true
   \ set! extensions.https_everywhere._observatory.priv_dns=true
   \ set! extensions.testpilot.alwaysSubmitData=true
   \ set! extensions.testpilot.popup.showOnNewResults=true
   \ set! extensions.testpilot.popup.showOnNewStudy=true
   \ extadd https://adblockplus.org/devbuilds/adblockplus/00latest.xpi
   \ set! extensions.adblockplus.detachsidebar=true
   \ set! services.sync.engine.adblockplus=true
   \ set! plugins.hide_infobar_for_missing_plugin=true
   \ set! app.update.enabled=false
   \ set! browser.download.manager.alertOnEXEOpen=false
   \ set! browser.download.manager.scanWhenDone=false
   \ set! browser.preferences.instantApply=true
   \ set! browser.search.context.loadInBackground=true
   \ set! browser.search.suggest.enabled=false
   \ set! intl.charset.default=UTF-8
   \ set! network.http.pipelining=true
   \ set! network.http.pipelining.aggressive=true
   \ set! network.http.pipelining.ssl=true
   \ set! network.http.proxy.pipelining=true
   \ set! network.http.spdy.enabled=true
   \ set! network.protocol-handler.expose.magnet=false
   \ set! services.sync.engine.prefs=false
   \ set! toolkit.telemetry.enabled=true
   \ js services.permissions.add(services.io.newURI("http:depositfiles.com",null,null), 'image', services.permissions.DENY_ACTION)
   \ js services.permissions.add(services.io.newURI("http:blip.tv",null,null), 'image', services.permissions.DENY_ACTION)
   \ js services.permissions.add(services.io.newURI("http:oglaf.com",null,null), 'plugins', services.permissions.ALLOW_ACTION)
   \ js services.permissions.add(services.io.newURI("http:www.google.com",null,null), 'popup', services.permissions.ALLOW_ACTION)
   \ js services.permissions.add(services.io.newURI("http:flecu.zahe.me",null,null), 'popup', services.permissions.ALLOW_ACTION)
   \ js services.loginManager.setLoginSavingEnabled("accounts.google.com", false)

set pk+=smbc-comics.com:x
autocmd PageLoad www.smbc-comics.com -javascript <<EOS
doc.querySelector('.comicboxcenter').scrollIntoView();
EOS
style -n "smbc red button" www.smbc-comics.com <<EOS
#aftercomic {
  display: block !important;
  position: static !important;
}
EOS

" thanks to Un-UTM Location Bar by Bruno Barão at https://www.userscripts.org/scripts/show/93825
" and dactyl by Kris Maglione with https://code.google.com/p/dactyl/source/detail?r=15b2632ff06e72e863d80fba5df9f3b037b94a06 for the code
autocmd DOMLoad (utm|wa)_ -js win.history.replaceState("Remove trackers", '', doc.location.href.replace(/&?(utm|wa)_[^&]+/g,'').replace(/\?$/,''))

map <C-[> 2b
" trigger on PageLoad so that the password is filled in
autocmd PageLoad (hb4pm4eznzhd6mts.onion|vh2e7a2imnfcr2rauxb3v6dxehe7wuxthucgcg2oh6bw22tyljtq.b32.i2p)/.+train\.php -javascript <<EOS
try {
    doc.querySelector('#good button, [value="Good"]').accessKey='e';
    doc.querySelector('#bad button,   [value="Bad"]').accessKey=',';
    doc.querySelector('select').accessKey='o'
    doc.querySelector('select').tabIndex=1;
} catch (e if e instanceof TypeError) {
    doc.querySelector('[value="Login"]').form.submit()
}
EOS
autocmd DOMLoad (hb4pm4eznzhd6mts.onion|vh2e7a2imnfcr2rauxb3v6dxehe7wuxthucgcg2oh6bw22tyljtq.b32.i2p)/pe/train.php -javascript <<EOS
try {
    doc.querySelector('[value="Good"]').accessKey='e';
    doc.querySelector('[value="Bad"]').accessKey=',';
} catch (e){}
EOS
style -n "yape" (hb4pm4eznzhd6mts.onion|vh2e7a2imnfcr2rauxb3v6dxehe7wuxthucgcg2oh6bw22tyljtq.b32.i2p)/.+train\.php <<EOS
img:not([src$="thumb"]) { position: fixed; bottom: 0; max-width: 700px; max-height: 98% }
[value="Good"] { float: left }
body { margin: 0 }
td { padding: 0 !important }
p:last-child { display: block; position: fixed; bottom: 0; right: 0 }
body > a, h1, p
, form td:last-child:not(#imgslot)
, #settings td>:not(select), #keyslot
{ display: none }
EOS

set passkeys+=mail.google.com/mail/:'#!ms+-/? jknpu'

set passkeys+=flecu.zahe.me:'vonp<Left><Right>smrUS'

map + -js <<EOS
dactyl.open("https://plusone.google.com/_/+1/fastbutton?url=" + encodeURIComponent(content.location.href)
           ,{ from: 'links', where: dactyl.NEW_TAB })
EOS
autocmd PageLoad https://plusone.google.com/_/+1/* -js <<EOS
doc.querySelector('#plusone [role="button"], [guidedhelpid="sharebutton"]')
                 .accessKey = 'e'
EOS

autocmd PageLoad https://ca.isohunt.com/lite/* <<EOS
feedkeys <Esc>
EOS
style -n "isohunt" isohunt.com .listing { margin-right: 0 !important; background-color: white !important }

style -n "link colors" * :visited { color: #859900 !important } :link[href^="#"] { color: #268bd2 !important }
style -n "gif decor" * <<EOS
:-moz-any(
  [src*="cyborgmatt.com/"]
, [src*="forgifs"]
, [src*="fukung"]
, [src*="imgur"]
, [src*="kuvaton"]
, [src*="myconfinedspace"]
, [src*="soup.io/asset/"]
, [src*="tumblr"]
, [src*="xkcd.com/comic"]
)[src$=".gif"] { border-right: 2px dotted #d33682 !important}
EOS
style -n "titled image decor" * <<EOS
img[title]:not(:-moz-any(
[title=""]
, [src*='buttersafe.com/']
, [src*='calmblueoceans.com/']
, [src*='chainsawsuit.com/']
, [src*='e-merl.com']
, [src*='endlessorigami.com/']
, [src*='everydayblues.net/']
, [src*='happletea.com/']
, [src*='hejibits.com/']
, [src*='hipsterhitler.com/']
, [src*='invisiblebread.com/']
, [src*='johnnywander.com/']
, [src*='lastplacecomics.com/']
, [src*='lunchbreath.com/']
, [src*='mimiandeunice.com/']
, [src*='neatorama.com/']
, [src*='pandyland.net/']
, [src*='pbfcomics.com/']
, [src*='pidjin.net/']
, [src*='ribbonfarm.com/']
, [src*='robbieandbobby.com/']
, [src*='rockpapercynic.com/']
, [src*='satwcomic.com/']
, [src*='savagechickens.com/']
, [src*='shoeboxblog.com/']
, [src*='stupidfox.net/']
, [src*='tedmccagg.typepad.com/']
, [src*='terminally-incoherent.com/']
, [src*='thebadchemicals.com/']
, [src*='todayifoundout.com/']
, [src*='uncubedthecomic.com/']
, [src*='upup-downdown.com/']
, [src*='warehousecomic.com/']
))
{ outline: 2px dashed #6c71c4; outline-offset: 1px }
EOS

style -n "link decor: good hosts" * <<EOS
  [href*="depositfiles.com/"] /* clean UI, reasonable waiting */
, [href*="hotfile.com/"]
, [href*="ifile.it"]
, [href*="mediafire.com/"],[href*="mfi.re/"]
, [href*="megashare.com/"]
, [href*="min.us/"], [href*="minus.com/"]
, [href*="rapidshare.com/"]
, [href*="ul.to/"], [href*="uploaded.to/"], [href*="uploaded.net/"]
, [href*="youporn.com/"] /* download links */
{ text-decoration: overline !important; -moz-text-decoration-style: wavy !important }
EOS
style -n "link decor: bad hosts" * <<EOS
  [href*="fileserve.com/"] /* slow UI */
, [href*="filesmonster.com/"] /* bad UI and splits big files */
, [href*="filesonic.com/"] /* horrid UI */
, [href*="megaupload.com/"]
, [href*="oron.com/"] /* 60s */
, [href*="uploading.com/"] /* 60s */
{ text-decoration: line-through !important; -moz-text-decoration-style: wavy !important }
EOS
style -n "link decor: youtube-dl" * <<EOS
:-moz-any(
  [href*="blip.tv/"]
, [href*="collegehumor.com/video/"]
, [href*="dailymotion."][href*="/video/"]
, [href*="escapistmagazine.com/videos/view/"]
, [href*="infoq.com/"]
, [href*="mixcloud.com/"]
, [href*="mtv.com/videos/"]
, [href*="soundcloud.com/"]
, [href*="twitch.tv/"]
, [href*="viddler.com/"]
, [href*="video.google.com/"]
, [href*="vimeo.com/"]
, [href*="video.xnxx.com/video"]
, [href*="xvideos.com/video"]
, [href*="youku.com/v_show/"]
, [href*="youtu.be/"],[href*="youtube.com/watch?"]
)::after { content: "\21af" }
EOS

style -n "link decor: ignco" ignorethecode.net :link { text-decoration: underline !important }
style -n "link decor: dansdata" www.dansdata.com a:not([href^="http"])::after { content: "\22c6" }
style -n "link decor: people" * <<EOS
:-moz-any(
  [href*="/~cks/"]
, [href*="advogato.org/person/apenwarr/"]
, [href*="alumnit.ca/~apenwarr/"]
, [href*="apenwarr.ca/"]
, [href*="aaronland.info/"]
, [href*="backofthecerealbox.com/"]
, [href*="betterexplained.com/"]
, [href*="//girtby.net/"]
, [href*="ignorethecode.net/"]
, [href*="johndcook.com/"]
, [href*="kidicarus222.blogspot.com/"]
, [href*="leancrew.com/"]
, [href*="/oldnewthing/archive/"]
, [href*="pixelbeat.org/"]
, [href*="//plasmasturm.org/"]
, [href*="plover.com/"]
, [href*="//prog21.dadgum.com/"]
, [href*="shamusyoung.com/"]
, [href*="terminally-incoherent.com/"]
)::after { content: "\22c6" }
EOS
style -n "link decor: WP" * [href*=".wikipedia.org/"]::before { content: url(https://en.wikipedia.org/favicon.ico) }

style -n "link decor: tvtropes" * <<EOS
[href*="tvtropes.org/"]::before { content: url(http://tvtropes.org/favicon.ico) }
@-moz-document domain("tvtropes.org") {
               [href*="tvtropes.org/"]::before { content: none }
}
EOS
style -n "tvtropes spoiler" tvtropes.org .spoiler { color: grey !important } .spoiler a { color: teal !important } a { text-decoration: underline !important }

style -n "lparchive" lparchive.org body { width: auto !important } [src$=".gif"] { border-right: 2px dotted #d33682 !important}

style -n "cracked" cracked.com <<EOS
#PrimaryContent .body section [href*="cracked.com/"]:not(.stronglinks) {
     background: no-repeat url(http:/www.cracked.com/favicon.ico);
     padding-left: 32px !important;
}
.Body, .body { padding-left: 0 !important }
EOS

style -n "girtby" girtby.net a { text-decoration: underline !important }

style -n "phoronix" www.phoronix.com #phxcms_content_right { float: none !important }

style -n "dota2wiki" www.dota2wiki.com #bodyContent2 { margin-right: 0 !important} #curse-panel { display: none }

style -n "d20" www.shamusyoung.com [href^="?"]::after { content: "\22c6" }
