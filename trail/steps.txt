# -*- mode: org -*-
* Changing profile pictures [8/8]
 - [X] [[https://www.facebook.com/hdh000][Facebook]]
 - [X] [[https://github.com/settings/profile][Github]]
 - [X] [[https://plus.google.com/110711359835920217300/about][Google]]
 - [X] [[https://en.gravatar.com/emails][Gravatar]]
 - [X] [[http://www.last.fm/settings][Last.fm]]
 - [X] [[https://profile.live.com/cid-13197dc9e233bef0/details/Edit/Pic][Microsoft]]
 - [X] [[http://steamcommunity.com/id/lasigmaz/edit][Steam]]
 - [X] [[https://twitter.com/lasigma?edit%3Dtrue][Twitter]]
* Cleaning old items in selfoss
  :PROPERTIES:
  :header-args:sql: :engine mysql :dbhost 192.168.1.54 :dbuser selfoss :database selfoss
  :END:
Some feeds come with all items since the beginning, and every 30 days,
selfoss drops them from the database and treat the feed as totally
new. This mark all but the 5 newest items in each feed as read.
 1. Create procedures to mark items matching a link pattern as read,
    and mark the top 5 items as unread. Newer items come at the
    beginning of the feed, and thus has lower id in database
    #+name: create-procedures
    #+begin_src sql
      use selfoss;
      create procedure read_all (pattern char(30))
             update items set unread = 0 where link like concat('%',pattern,'%');
      create procedure mark_5_unread (pattern char(30))
             update items set unread = 1 where link like concat('%',pattern,'%')
                          limit 5;
    #+end_src
 2. Mark read and unread items with these patterns
    #+name: mark-items
    #+begin_src sql
      use selfoss;
      call read_all('http://drawingboardcomic.com');
      call mark_5_unread('http://drawingboardcomic.com');
      call read_all('http://oglaf.com/');
      call mark_5_unread('http://oglaf.com/');
      call read_all('giantitp.com/comics/oots');
      call mark_5_unread('giantitp.com/comics/oots');
      call read_all('/satwcomic/');
      call mark_5_unread('/satwcomic/');
      call read_all('/stupidfox/');
      call mark_5_unread('/stupidfox/');
    #+end_src
* Installing Arch
  #+begin_src sh
    loadkeys dvorak
    mkfs root
    mkfs.vfat boot
    mount root /mnt
    mount boot /mnt/boot
    vim /etc/pacman.d/mirrorlist
    pacstrap /mnt base base-devel zsh git ntp vim btrfs-progs
    genfstab /mnt >> /mnt/etc/fstab
    arch-chroot /mnt
    ln -s /usr/lib/systemd/system/systemd-{network,resolve,timesync}d.service /etc/systemd/system/multi-user.target.wants/
    ln -sf /run/systemd/resovled/resolv.conf /etc/resolv.conf
    vim /etc/systemd/network/net.network
    ln -s /usr/share/zoneinfo/Asia/Ho_Chi_Minh /etc/localtime
    echo KEYMAP=dvorak > /etc/vconsole.conf
    echo LANG=en_US.UTF-8 > /etc/locale.conf
    vim /etc/locale.gen && locale-gen
    visudo
    useradd hdhoang -m -g users -G wheel,systemd-journal
    passwd
    passwd hdhoang
  #+end_src
* Picard
  Date formatting:
  : $if(%date%,\(%date%\) )
* Two-factor authentication for ssh
 1. Install either [[https://code.google.com/p/google-authenticator/wiki/PamModuleInstructions][google-authenticator]] or [[http://www.nongnu.org/oath-toolkit/][OATH toolkit]], then set up
    the secret
 2. Enable the PAM module
 3. In sshd_config:
    : ChallengeResponseAuthentication yes
 4. To allow publickey login:
    : AuthenticationMethods publickey keyboard-interactive:pam
