#!/usr/bin/python

from PyQt4 import QtCore, QtDBus

app = QtCore.QCoreApplication([''])

class Dummy(QtCore.QObject):
      @QtCore.pyqtSlot(str, QtDBus.QDBusVariant)
      def exit_when_online(self, name, value):
            if name == "State" and value.variant() == "online":
                  app.quit()
obj = Dummy()

bus = QtDBus.QDBusConnection.systemBus()
bus.connect("net.connman",
            "/",
            "net.connman.Manager",
            "PropertyChanged",
            obj.exit_when_online)

app.exec_()
